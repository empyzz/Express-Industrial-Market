<header class="header">
    <div class="header__main">
        <div class="container">
            
            <!-- Logo -->
            <a href="/" class="header__logo">
                <i class="fa-solid fa-industry"></i>
                <span>Marketplace</span>
            </a>

            <!-- Barra de Pesquisa Central -->
            <div class="header__search-wrapper">
                <form action="/search" method="GET" class="header__search">
                    <input type="text" name="q" class="header__search-input" placeholder="Buscar produtos ou fornecedores..." required autocomplete="off">
                    <button type="submit" class="header__search-button" aria-label="Buscar">
                        <i class="fa-solid fa-magnifying-glass"></i>
                    </button>
                </form>
            </div>

            <!-- Ações e Navegação do Usuário -->
            <div class="header__actions">
                <% if (!user) { %>
                    <!-- Menu para Visitantes -->
                    <nav class="header__nav--visitor">
                        <a href="/catalog" class="header__nav-link">Catálogo</a>
                        <a href="/auth/login" class="btn btn--outline">Entrar</a>
                        <a href="/auth/register" class="btn btn--primary">Cadastre-se</a>
                    </nav>
                <% } else { %>
                    <% if (user.userType == "SUPPLIER") { %>
                    <nav class="header__nav--user">
                        <a href="/supplier/dashboard" class="header__action-btn" title="Dashboard">
                            <i class="fa-solid fa-table-columns"></i>
                            <span>Dashboard</span>
                        </a>
                    <% } %>

                    <% if (user.userType == "BUYER") { %>
                    <nav class="header__nav--user">
                        <a href="/buyer/cart" class="header__action-btn" title="Carrinho">
                            <i class="fa-solid fa-cart-shopping"></i>
                            <span>Carrinho</span>
                        </a>
                    <% } %>


                        <a href="/catalog" class="header__nav-link">Catálogo</a>

                        <!-- Dropdown do Usuário -->
                        <div class="user-dropdown">
                            <button class="user-dropdown__toggle" aria-label="Menu do usuário">
                                <img src="<%= user.avatar || '/images/default-avatar.png' %>" alt="Avatar de <%= user.name %>" class="user-avatar">
                                <span class="user-name"><%= user.name.split(' ')[0] %></span>
                                <i class="fa-solid fa-chevron-down"></i>
                            </button>
                            <div class="user-dropdown__menu">
                                <div class="user-dropdown__header">
                                    <strong><%= user.name %></strong>
                                    <small><%= user.email %></small>
                                </div>

                                <% if (user.userType === "SUPPLIER") { %>

                                    <% if (user.company) { %>
                                        <a href="/suppliers/<%= user.company.id %>"><i class="fa-solid fa-store"></i> Ver Minha Loja</a>
                                        <a href="/supplier/profile/edit"><i class="fa-solid fa-pen-to-square"></i> Editar Loja</a>
                                    <% } else { %>
                                        <a href="/auth/complete-profile" class="link-emphasis">
                                            <i class="fa-solid fa-exclamation-circle"></i> Complete seu Perfil
                                        </a>
                                    <% } %>

                                <% } %>
                            <% if (user.userType === "BUYER") { %>
                                <a href="/buyer/profile"><i class="fa-solid fa-user-gear"></i> Meu Perfil</a>
                            <% } %>

                                
                                <a href="/orders"><i class="fa-solid fa-box-archive"></i> Meus Pedidos</a>
                                <a href="/favorites"><i class="fa-solid fa-heart"></i> Favoritos</a>
                                <hr>
                                <a href="/auth/logout" class="logout-link"><i class="fa-solid fa-right-from-bracket"></i> Sair</a>
                            </div>
                        </div>
                    </nav>
                <% } %>
            </div>

            <!-- Botão do Menu Mobile -->
            <button class="header__mobile-toggle" aria-label="Abrir menu">
                <i class="fa-solid fa-bars"></i>
            </button>

        </div>
    </div>
</header>
