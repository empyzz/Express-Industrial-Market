<aside class="dashboard-sidebar">
  <div class="sidebar-header">
    <div class="sidebar-user">
      <img 
        src="<%= user.avatar || '/images/default-avatar.png' %>" 
        alt="<%= user.name %>"
        class="sidebar-avatar"
      >
      <div class="sidebar-user-info">
        <strong><%= user.name %></strong>
        <span class="user-type">
          <%= user.type === 'buyer' ? 'Comprador' : 'Fornecedor' %>
        </span>
      </div>
    </div>
  </div>

  <nav class="sidebar-nav">
    
    <% if (user.type === 'buyer') { %>
      <!-- Menu do Comprador -->
      <a href="/buyer/dashboard" class="sidebar-link <%= active === 'dashboard' ? 'active' : '' %>">
        <i class="fas fa-tachometer-alt"></i>
        <span>Dashboard</span>
      </a>

      <a href="/buyer/products/search" class="sidebar-link <%= active === 'products' ? 'active' : '' %>">
        <i class="fas fa-search"></i>
        <span>Buscar Produtos</span>
      </a>

      <a href="/buyer/quotations" class="sidebar-link <%= active === 'quotations' ? 'active' : '' %>">
        <i class="fas fa-file-invoice"></i>
        <span>Minhas Cotações</span>
        <% if (typeof stats !== 'undefined' && stats.pendingQuotations > 0) { %>
          <span class="badge badge-warning"><%= stats.pendingQuotations %></span>
        <% } %>
      </a>

      <a href="/buyer/orders" class="sidebar-link <%= active === 'orders' ? 'active' : '' %>">
        <i class="fas fa-shopping-cart"></i>
        <span>Meus Pedidos</span>
        <% if (typeof stats !== 'undefined' && stats.activeOrders > 0) { %>
          <span class="badge badge-primary"><%= stats.activeOrders %></span>
        <% } %>
      </a>

      <div class="sidebar-divider"></div>

      <a href="/auth/favorites" class="sidebar-link <%= active === 'favorites' ? 'active' : '' %>">
        <i class="fas fa-heart"></i>
        <span>Favoritos</span>
        <% if (user.favorites && (user.favorites.products?.length > 0 || user.favorites.suppliers?.length > 0)) { %>
          <span class="badge"><%= (user.favorites.products?.length || 0) + (user.favorites.suppliers?.length || 0) %></span>
        <% } %>
      </a>

      <a href="/buyer/profile" class="sidebar-link <%= active === 'profile' ? 'active' : '' %>">
        <i class="fas fa-user-cog"></i>
        <span>Meu Perfil</span>
      </a>

      <a href="/auth/notifications" class="sidebar-link <%= active === 'notifications' ? 'active' : '' %>">
        <i class="fas fa-bell"></i>
        <span>Notificações</span>
        <% if (user.notifications && user.notifications.filter(n => !n.read).length > 0) { %>
          <span class="badge badge-danger"><%= user.notifications.filter(n => !n.read).length %></span>
        <% } %>
      </a>

    <% } else if (user.type === 'supplier') { %>
      <!-- Menu do Fornecedor -->
      <a href="/supplier/dashboard" class="sidebar-link <%= active === 'dashboard' ? 'active' : '' %>">
        <i class="fas fa-tachometer-alt"></i>
        <span>Dashboard</span>
      </a>

      <a href="/supplier/products" class="sidebar-link <%= active === 'products' ? 'active' : '' %>">
        <i class="fas fa-box"></i>
        <span>Meus Produtos</span>
        <% if (typeof stats !== 'undefined' && stats.totalProducts) { %>
          <span class="badge"><%= stats.totalProducts %></span>
        <% } %>
      </a>

      <a href="/supplier/products/new" class="sidebar-link <%= active === 'new-product' ? 'active' : '' %>">
        <i class="fas fa-plus-circle"></i>
        <span>Novo Produto</span>
      </a>

      <div class="sidebar-divider"></div>

      <a href="/supplier/quotations" class="sidebar-link <%= active === 'quotations' ? 'active' : '' %>">
        <i class="fas fa-file-invoice"></i>
        <span>Cotações Recebidas</span>
        <% if (typeof stats !== 'undefined' && stats.pendingQuotations > 0) { %>
          <span class="badge badge-warning"><%= stats.pendingQuotations %></span>
        <% } %>
      </a>

      <a href="/supplier/orders" class="sidebar-link <%= active === 'orders' ? 'active' : '' %>">
        <i class="fas fa-shopping-cart"></i>
        <span>Pedidos</span>
        <% if (typeof stats !== 'undefined' && stats.activeOrders > 0) { %>
          <span class="badge badge-primary"><%= stats.activeOrders %></span>
        <% } %>
      </a>

      <div class="sidebar-divider"></div>

      <a href="/supplier/store-profile" class="sidebar-link <%= active === 'store-profile' ? 'active' : '' %>">
        <i class="fas fa-store"></i>
        <span>Perfil da Loja</span>
      </a>

      <a href="/supplier/reviews" class="sidebar-link <%= active === 'reviews' ? 'active' : '' %>">
        <i class="fas fa-star"></i>
        <span>Avaliações</span>
        <% if (typeof stats !== 'undefined' && stats.totalReviews) { %>
          <span class="badge"><%= stats.totalReviews %></span>
        <% } %>
      </a>

      <a href="/supplier/statistics" class="sidebar-link <%= active === 'statistics' ? 'active' : '' %>">
        <i class="fas fa-chart-bar"></i>
        <span>Estatísticas</span>
      </a>

      <div class="sidebar-divider"></div>

      <a href="/auth/profile" class="sidebar-link <%= active === 'profile' ? 'active' : '' %>">
        <i class="fas fa-user-cog"></i>
        <span>Configurações</span>
      </a>

      <a href="/auth/notifications" class="sidebar-link <%= active === 'notifications' ? 'active' : '' %>">
        <i class="fas fa-bell"></i>
        <span>Notificações</span>
        <% if (user.notifications && user.notifications.filter(n => !n.read).length > 0) { %>
          <span class="badge badge-danger"><%= user.notifications.filter(n => !n.read).length %></span>
        <% } %>
      </a>

    <% } %>

    <div class="sidebar-divider"></div>

    <a href="/" class="sidebar-link">
      <i class="fas fa-home"></i>
      <span>Voltar ao Site</span>
    </a>

    <a href="/auth/logout" class="sidebar-link text-danger">
      <i class="fas fa-sign-out-alt"></i>
      <span>Sair</span>
    </a>
  </nav>

  <div class="sidebar-footer">
    <div class="sidebar-help">
      <i class="fas fa-question-circle"></i>
      <div>
        <strong>Precisa de ajuda?</strong>
        <a href="/contato">Entre em contato</a>
      </div>
    </div>
  </div>
</aside>

<!-- Mobile Sidebar Toggle -->
<button class="mobile-sidebar-toggle" onclick="toggleSidebar()">
  <i class="fas fa-bars"></i>
</button>

<div class="sidebar-overlay" onclick="toggleSidebar()"></div>

<script>
function toggleSidebar() {
  const sidebar = document.querySelector('.dashboard-sidebar');
  const overlay = document.querySelector('.sidebar-overlay');
  const body = document.body;
  
  sidebar.classList.toggle('active');
  overlay.classList.toggle('active');
  body.classList.toggle('sidebar-open');
}

// Fecha sidebar ao clicar em um link (mobile)
if (window.innerWidth < 992) {
  document.querySelectorAll('.sidebar-link').forEach(link => {
    link.addEventListener('click', () => {
      toggleSidebar();
    });
  });
}
</script>